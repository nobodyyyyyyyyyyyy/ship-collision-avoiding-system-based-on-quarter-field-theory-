%Author: Zhang Ziqing
%University: Wuhan University of Technology
%Contact Email: 322980@whut.edu.cn
%Feedback and Support
%If you have any questions, suggestions, or would like to contribute, feel free to contact me 
% or raise an issue on the GitHub Issues page.
function [equation] = simplify_equation (equation0)
% clc,clear;
syms t x;

% equation0 = (16871217686198170331186158111321*(213980637487098985219002204160*3^(1/2)*t - 191047122835182070169524530205*t - 96130801391079219109636740218880*3^(1/2) + (1261981039115467862185082880*(-(126584701271852249722676877107031905013811470152070758476365124541734673448960*3^(1/2)*t - 426736853992133417166293854674204471575273541772287593952002445614400845905920*t + 3167289556326239394011277733025095177203922861242642118362628777574400*5^(1/2)*(140737488355328*10^(841/1000)*(t + 1)^(5441/5000) + 11402755080101485)^(1/2) + 522532630787594588776986544982608356858704710320092023586227539148800*15^(1/2)*(140737488355328*10^(841/1000)*(t + 1)^(5441/5000) + 11402755080101485)^(1/2) + 254301518373972602293628114210549282626963903704048242573536197653993525084160*3^(1/2) - 283028957567025712068589999121368149835240849976681405201487142631044546560*3^(1/2)*t^2 + 601853686992362205709736274686711525043214501255170848536264929477729976320*t^2 - 32868025420319605697649885631505165478326303244861957310297338351961902153728*10^(341/500)*(t + 1)^(5441/2500) - 55417705514202851931500274746417789871993726380948746267736258952006169788416*10^(841/1000)*(t + 1)^(5441/5000) + 1236674450173160814759562357215790879570643841237347838268643737600*5^(1/2)*t^2*(140737488355328*10^(841/1000)*(t + 1)^(5441/5000) + 11402755080101485)^(1/2) - 581561080453638941321075731755824548535008024841504756356402380800*15^(1/2)*t^2*(140737488355328*10^(841/1000)*(t + 1)^(5441/5000) + 11402755080101485)^(1/2) + 2936825342613527719674797496579423776551896085761300361560383406565037703168*3^(1/2)*10^(841/1000)*(t + 1)^(5441/5000) - 4928211264504721461672194715099378562780009871740609681459069025215175458816*10^(841/1000)*t*(t + 1)^(5441/5000) - 876848602384724094204439105400288027218920058588591917496842951065600*5^(1/2)*t*(140737488355328*10^(841/1000)*(t + 1)^(5441/5000) + 11402755080101485)^(1/2) + 260103193232890016505851121027792529332282339110363002280400964812800*15^(1/2)*t*(140737488355328*10^(841/1000)*(t + 1)^(5441/5000) + 11402755080101485)^(1/2) + 6950564714699179391305650520380291536124537459475411803171644174275444736*10^(841/1000)*t^2*(t + 1)^(5441/5000) - 3268586914427966299025929322848551782472894920157262505910276468074610688*3^(1/2)*10^(841/1000)*t^2*(t + 1)^(5441/5000) + 1461875497477907927239346889644014784711002253040335655768371150346369630208*3^(1/2)*10^(841/1000)*t*(t + 1)^(5441/5000) - 5848020834766146976138208451823541562650862602131038870437347773644800*2^(841/1000)*5^(341/1000)*(140737488355328*10^(841/1000)*(t + 1)^(5441/5000) + 11402755080101485)^(1/2)*(t + 1)^(5441/5000) + 20253347530587537166500239645927004656835739605225711053403826407946404033573275)/(2459715770785057360477106995200*5^(1/2)*(140737488355328*10^(841/1000)*(t + 1)^(5441/5000) + 11402755080101485)^(1/2) + 798268144716302446416176481019363328*10^(341/500)*(t + 1)^(5441/2500) + 15602782340630241021840380148341276672*10^(841/1000)*(t + 1)^(5441/5000) + 142031311048732310340685004800*2^(841/1000)*5^(341/1000)*(140737488355328*10^(841/1000)*(t + 1)^(5441/5000) + 11402755080101485)^(1/2)*(t + 1)^(5441/5000) + 742614767069904030642442196722372161445))^(1/2))/4107458786914139 + (2593088222946918400*5^(1/2)*(140737488355328*10^(841/1000)*(t + 1)^(5441/5000) + 11402755080101485)^(1/2)*(-(126584701271852249722676877107031905013811470152070758476365124541734673448960*3^(1/2)*t - 426736853992133417166293854674204471575273541772287593952002445614400845905920*t + 3167289556326239394011277733025095177203922861242642118362628777574400*5^(1/2)*(140737488355328*10^(841/1000)*(t + 1)^(5441/5000) + 11402755080101485)^(1/2) + 522532630787594588776986544982608356858704710320092023586227539148800*15^(1/2)*(140737488355328*10^(841/1000)*(t + 1)^(5441/5000) + 11402755080101485)^(1/2) + 254301518373972602293628114210549282626963903704048242573536197653993525084160*3^(1/2) - 283028957567025712068589999121368149835240849976681405201487142631044546560*3^(1/2)*t^2 + 601853686992362205709736274686711525043214501255170848536264929477729976320*t^2 - 32868025420319605697649885631505165478326303244861957310297338351961902153728*10^(341/500)*(t + 1)^(5441/2500) - 55417705514202851931500274746417789871993726380948746267736258952006169788416*10^(841/1000)*(t + 1)^(5441/5000) + 1236674450173160814759562357215790879570643841237347838268643737600*5^(1/2)*t^2*(140737488355328*10^(841/1000)*(t + 1)^(5441/5000) + 11402755080101485)^(1/2) - 581561080453638941321075731755824548535008024841504756356402380800*15^(1/2)*t^2*(140737488355328*10^(841/1000)*(t + 1)^(5441/5000) + 11402755080101485)^(1/2) + 2936825342613527719674797496579423776551896085761300361560383406565037703168*3^(1/2)*10^(841/1000)*(t + 1)^(5441/5000) - 4928211264504721461672194715099378562780009871740609681459069025215175458816*10^(841/1000)*t*(t + 1)^(5441/5000) - 876848602384724094204439105400288027218920058588591917496842951065600*5^(1/2)*t*(140737488355328*10^(841/1000)*(t + 1)^(5441/5000) + 11402755080101485)^(1/2) + 260103193232890016505851121027792529332282339110363002280400964812800*15^(1/2)*t*(140737488355328*10^(841/1000)*(t + 1)^(5441/5000) + 11402755080101485)^(1/2) + 6950564714699179391305650520380291536124537459475411803171644174275444736*10^(841/1000)*t^2*(t + 1)^(5441/5000) - 3268586914427966299025929322848551782472894920157262505910276468074610688*3^(1/2)*10^(841/1000)*t^2*(t + 1)^(5441/5000) + 1461875497477907927239346889644014784711002253040335655768371150346369630208*3^(1/2)*10^(841/1000)*t*(t + 1)^(5441/5000) - 5848020834766146976138208451823541562650862602131038870437347773644800*2^(841/1000)*5^(341/1000)*(140737488355328*10^(841/1000)*(t + 1)^(5441/5000) + 11402755080101485)^(1/2)*(t + 1)^(5441/5000) + 20253347530587537166500239645927004656835739605225711053403826407946404033573275)/(2459715770785057360477106995200*5^(1/2)*(140737488355328*10^(841/1000)*(t + 1)^(5441/5000) + 11402755080101485)^(1/2) + 798268144716302446416176481019363328*10^(341/500)*(t + 1)^(5441/2500) + 15602782340630241021840380148341276672*10^(841/1000)*(t + 1)^(5441/5000) + 142031311048732310340685004800*2^(841/1000)*5^(341/1000)*(140737488355328*10^(841/1000)*(t + 1)^(5441/5000) + 11402755080101485)^(1/2)*(t + 1)^(5441/5000) + 742614767069904030642442196722372161445))^(1/2))/4107458786914139 + (14574108409851263187943424*10^(841/1000)*(-(126584701271852249722676877107031905013811470152070758476365124541734673448960*3^(1/2)*t - 426736853992133417166293854674204471575273541772287593952002445614400845905920*t + 3167289556326239394011277733025095177203922861242642118362628777574400*5^(1/2)*(140737488355328*10^(841/1000)*(t + 1)^(5441/5000) + 11402755080101485)^(1/2) + 522532630787594588776986544982608356858704710320092023586227539148800*15^(1/2)*(140737488355328*10^(841/1000)*(t + 1)^(5441/5000) + 11402755080101485)^(1/2) + 254301518373972602293628114210549282626963903704048242573536197653993525084160*3^(1/2) - 283028957567025712068589999121368149835240849976681405201487142631044546560*3^(1/2)*t^2 + 601853686992362205709736274686711525043214501255170848536264929477729976320*t^2 - 32868025420319605697649885631505165478326303244861957310297338351961902153728*10^(341/500)*(t + 1)^(5441/2500) - 55417705514202851931500274746417789871993726380948746267736258952006169788416*10^(841/1000)*(t + 1)^(5441/5000) + 1236674450173160814759562357215790879570643841237347838268643737600*5^(1/2)*t^2*(140737488355328*10^(841/1000)*(t + 1)^(5441/5000) + 11402755080101485)^(1/2) - 581561080453638941321075731755824548535008024841504756356402380800*15^(1/2)*t^2*(140737488355328*10^(841/1000)*(t + 1)^(5441/5000) + 11402755080101485)^(1/2) + 2936825342613527719674797496579423776551896085761300361560383406565037703168*3^(1/2)*10^(841/1000)*(t + 1)^(5441/5000) - 4928211264504721461672194715099378562780009871740609681459069025215175458816*10^(841/1000)*t*(t + 1)^(5441/5000) - 876848602384724094204439105400288027218920058588591917496842951065600*5^(1/2)*t*(140737488355328*10^(841/1000)*(t + 1)^(5441/5000) + 11402755080101485)^(1/2) + 260103193232890016505851121027792529332282339110363002280400964812800*15^(1/2)*t*(140737488355328*10^(841/1000)*(t + 1)^(5441/5000) + 11402755080101485)^(1/2) + 6950564714699179391305650520380291536124537459475411803171644174275444736*10^(841/1000)*t^2*(t + 1)^(5441/5000) - 3268586914427966299025929322848551782472894920157262505910276468074610688*3^(1/2)*10^(841/1000)*t^2*(t + 1)^(5441/5000) + 1461875497477907927239346889644014784711002253040335655768371150346369630208*3^(1/2)*10^(841/1000)*t*(t + 1)^(5441/5000) - 5848020834766146976138208451823541562650862602131038870437347773644800*2^(841/1000)*5^(341/1000)*(140737488355328*10^(841/1000)*(t + 1)^(5441/5000) + 11402755080101485)^(1/2)*(t + 1)^(5441/5000) + 20253347530587537166500239645927004656835739605225711053403826407946404033573275)/(2459715770785057360477106995200*5^(1/2)*(140737488355328*10^(841/1000)*(t + 1)^(5441/5000) + 11402755080101485)^(1/2) + 798268144716302446416176481019363328*10^(341/500)*(t + 1)^(5441/2500) + 15602782340630241021840380148341276672*10^(841/1000)*(t + 1)^(5441/5000) + 142031311048732310340685004800*2^(841/1000)*5^(341/1000)*(140737488355328*10^(841/1000)*(t + 1)^(5441/5000) + 11402755080101485)^(1/2)*(t + 1)^(5441/5000) + 742614767069904030642442196722372161445))^(1/2)*(t + 1)^(5441/5000))/4107458786914139 - 382094245670364140339049060410))/(4628278817906886702295809741730822828261970752307200*5^(1/2)*(140737488355328*10^(841/1000)*(t + 1)^(5441/5000) + 11402755080101485)^(1/2) + 26012627201143249540801406137193946529906465945542031572992*10^(841/1000)*(t + 1)^(5441/5000) + 6378175515162879394101322506173676650299167079744638989809685)
 
equation = string(equation0);
matches = regexp(equation, '(\d+)', 'match');
numbers = str2double(matches);
numbers_above_10000 = numbers(numbers >= 10000);
indices_above_10000 = find(numbers >= 10000);
v = matches(indices_above_10000);
formatted_numbers = arrayfun(@(x) sprintf('%0.2e', x), numbers_above_10000, 'UniformOutput', false);
for i = 1:length(numbers_above_10000)
    equation = strrep(equation, v(i), formatted_numbers{i});
end
disp(equation)
equation = str2sym(equation);
% 
% prevResult = equation0;
% iterations = 0;
% sum_ = 0;
% while true
%     % Apply simplify, expand, and collect to both t and x
%     currentResult = simplify(expand(collect(prevResult, [t, x])), 'Steps', 10);
%     
%     % Check if the result has stabilized
%     if isequaln(currentResult, prevResult)
%         break;
%     end
%     
%     prevResult = currentResult;
%     iterations = iterations + 1;
% end
% 
% % Display the final result
% disp('Final result after iterations:');
% disp(prevResult);
% 
% % Split the result into terms
% terms = children(prevResult);
% iterations_ = 0;
% % Store the terms in a cell array after applying simplify, expand, and collect to each term
% terms_cell_array = cell(1, length(terms));
% for i = 1:length(terms)
%     term = terms(i);
%     prevResult_ = term;
%     while true
%     terms_cell_array{i} = collect(expand(term{1}));
%     if isequaln(terms_cell_array{i}, prevResult_) 
%         break;
%     end
%     prevResult_ = terms_cell_array{i};
%     iterations_ = iterations_ + 1;
% %     terms_cell{i} = subs(terms_cell_array{i}, x, 1);
% %     poly_expr = sym2poly(terms_cell{i});
%     end
%     sum_ = terms_cell_array{i} + sum_;
% end
% 
% equation = sum_;
% Display the stored terms
disp('Stored terms after iterations:');
disp(equation);
end